<div class="chat-container">
  <div class="chat-header">
    <h2>ConfeMate Assistant</h2>
    <p>Ask me about conference sessions and get personalized recommendations!</p>
    @if (chatService.messages().length > 0) {
      <button class="clear-button" (click)="onClearChat()">Clear Chat</button>
    }
  </div>

  <div class="messages-container">
    @if (chatService.messages().length === 0) {
      <div class="welcome-message">
        <h3>Welcome to ConfeMate!</h3>
        <p>I'm here to help you find the perfect conference sessions based on your interests, experience level, and schedule preferences.</p>
        <p>Try asking me something like:</p>
        <ul>
          <li>"I'm interested in Angular and have intermediate experience"</li>
          <li>"What beginner-friendly sessions are available?"</li>
          <li>"Show me sessions about AI and machine learning"</li>
        </ul>
      </div>
    }

    @for (message of chatService.messages(); track $index) {
      <div class="message" [class.user-message]="message.role === 'user'" [class.model-message]="message.role === 'model'">
        <div class="message-role">{{ message.role === 'user' ? 'You' : 'ConfeMate' }}</div>
        <div class="message-content">{{ message.content }}</div>
      </div>
    }

    @if (chatService.isLoading()) {
      <div class="message model-message loading">
        <div class="message-role">ConfeMate</div>
        <div class="message-content">
          <span class="loading-dots">Thinking</span>
        </div>
      </div>
    }

    @if (chatService.error()) {
      <div class="error-message">
        <div class="error-icon">⚠️</div>
        <div class="error-content">
          <div class="error-text">{{ chatService.error() }}</div>
          <button class="retry-button" (click)="onRetry()">Retry</button>
        </div>
      </div>
    }

    <div #messagesEnd></div>
  </div>

  @if (chatService.recommendations().length > 0) {
    <app-session-filters />
    <app-session-list [sessions]="filterService.filteredSessions()" />
  }

  <div class="input-container">
    <textarea
      [(ngModel)]="messageInput"
      (keypress)="onKeyPress($event)"
      placeholder="Ask about conference sessions..."
      [disabled]="chatService.isLoading()"
      rows="2"
    ></textarea>
    <button
      (click)="onSendMessage()"
      [disabled]="!messageInput().trim() || chatService.isLoading()"
      class="send-button"
    >
      Send
    </button>
  </div>
</div>
